# Changelog System - Quick Start Guide

A concise reference for using the automated changelog system.

## ğŸš€ One-Time Setup

### 1. Create Personal Access Token
```
GitHub Settings â†’ Developer Settings â†’ Personal Access Tokens â†’ Fine-grained tokens
â†’ Generate new token

Settings:
- Repository: Select your requirements repo
- Permissions:
  âœ“ Contents: Read and write
  âœ“ Pull requests: Read and write
```

### 2. Add Token to Repository
```
Repo Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret

Name: PAT_CHANGELOG
Value: [paste your token]
```

### 3. Copy Workflow Files
```bash
# Copy all .yml files to your repository
cp changelog-*.yml /path/to/your/repo/.github/workflows/

# Copy documentation (optional but recommended)
cp CHANGELOG_TEMPLATE.md /path/to/your/repo/docs/
cp CHANGELOG_SYSTEM_README.md /path/to/your/repo/docs/
```

### 4. Configure Branch Protection
```
Repo Settings â†’ Branches â†’ Add rule

Rules for: dev, test, preprod, main
âœ“ Require pull request reviews
âœ“ Require status checks to pass
âœ“ Require conversation resolution before merging
```

## ğŸ“ Daily Workflow

### Creating a Feature

```bash
# 1. Create feature branch (template auto-created!)
git checkout -b feature/user-authentication

# 2. Develop your feature
# ...

# 3. Update the auto-generated changelog
vim changelogs/feat-user-authentication.md

# 4. Commit and push
git add .
git commit -m "feat: implement user authentication"
git push origin feature/user-authentication

# 5. Create PR (validation runs automatically)
gh pr create --base dev
```

### Your Changelog File
```markdown
### Added
- OAuth2 login with Google and GitHub
- JWT token-based sessions
- User profile management

### Changed
- Login page redesigned
- API endpoints now require auth

### Technical Notes
- Migration: V003__create_users.sql
- New env vars: OAUTH_CLIENT_ID, OAUTH_CLIENT_SECRET
```

## ğŸ·ï¸ Releasing

### Pre-release (Testing/QA)
```bash
# On preprod branch
git checkout preprod
git tag v1.1.0-rc
git push origin v1.1.0-rc

# Workflow automatically:
# âœ“ Aggregates all feat-*.md files
# âœ“ Updates CHANGELOG.md
# âœ“ Creates GitHub pre-release
```

### Production Release
```bash
# On main branch
git checkout main
git tag v1.1.0
git push origin v1.1.0

# Workflow automatically:
# âœ“ Removes -rc from CHANGELOG.md
# âœ“ Archives changelogs/feat-*.md â†’ changelogs/1.1.0/
# âœ“ Creates GitHub release
```

## ğŸ“Š File Structure

```
your-repo/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ changelog-create-template.yml
â”‚       â”œâ”€â”€ changelog-validate.yml
â”‚       â”œâ”€â”€ changelog-aggregate-prerelease.yml
â”‚       â””â”€â”€ changelog-finalize-release.yml
â”œâ”€â”€ changelogs/
â”‚   â”œâ”€â”€ feat-user-auth.md          â† Active development
â”‚   â”œâ”€â”€ feat-templates.md           â† Active development
â”‚   â”œâ”€â”€ 1.1.0/                      â† Archived (released)
â”‚   â”‚   â”œâ”€â”€ feat-oauth.md
â”‚   â”‚   â””â”€â”€ feat-profiles.md
â”‚   â””â”€â”€ 1.0.0/                      â† Archived (released)
â”‚       â””â”€â”€ feat-initial.md
â”œâ”€â”€ CHANGELOG.md                     â† Generated by workflows
â””â”€â”€ docs/
    â”œâ”€â”€ CHANGELOG_TEMPLATE.md
    â””â”€â”€ CHANGELOG_SYSTEM_README.md
```

## ğŸ¯ Common Commands

```bash
# Create feature branch (triggers template creation)
git checkout -b feature/my-feature

# View your changelog
cat changelogs/feat-my-feature.md

# Tag pre-release
git tag v1.2.0-rc && git push origin v1.2.0-rc

# Tag production release
git tag v1.2.0 && git push origin v1.2.0

# View all releases
gh release list

# Delete a tag (if you make a mistake)
git tag -d v1.2.0-rc
git push origin :refs/tags/v1.2.0-rc
```

## âœ… Checklist: Before Creating PR

- [ ] Changelog file exists: `changelogs/feat-<feature-name>.md`
- [ ] At least one section has content (Added, Changed, Fixed, etc.)
- [ ] Technical Notes filled if there are migrations/breaking changes
- [ ] Removed empty sections
- [ ] Changes are user-focused and clear
- [ ] Bullet points are specific and actionable

## âœ… Checklist: Before Production Release

- [ ] All features tested on `test` branch
- [ ] Pre-release created and validated (`v1.x.0-rc`)
- [ ] CHANGELOG.md reviewed for accuracy
- [ ] Breaking changes documented
- [ ] Migration guide provided (if needed)
- [ ] All PRs to `main` approved and merged
- [ ] Tag follows semantic versioning (`vMAJOR.MINOR.PATCH`)

## ğŸ” Workflow Triggers

| Workflow | Triggers On | Does What |
|----------|-------------|-----------|
| **create-template** | Feature branch created | Creates `changelogs/feat-*.md` template |
| **validate** | PR to dev/test/preprod/main | Validates changelog exists and has content |
| **aggregate-prerelease** | Tag `v*-rc*` on preprod | Combines changelogs â†’ CHANGELOG.md, creates pre-release |
| **finalize-release** | Tag `v*` on main | Removes `-rc`, archives changelogs, creates release |

## ğŸ› Quick Troubleshooting

| Problem | Solution |
|---------|----------|
| Validation fails on PR | Check `changelogs/feat-<name>.md` exists with content |
| "Tag must be on preprod" | Pre-release tags (`-rc`) must be on `preprod` branch |
| "Tag must be on main" | Production tags must be on `main` branch |
| Workflow doesn't run | Check workflow files in `.github/workflows/` |
| Permission denied | Verify `PAT_CHANGELOG` secret exists and is valid |
| Template not created | Feature branch must start with `feature/` |

## ğŸ“– Changelog Sections Quick Reference

```markdown
### Added          â† New features
### Changed        â† Modifications to existing features
### Deprecated     â† Features being phased out
### Removed        â† Features that were removed
### Fixed          â† Bug fixes
### Security       â† Security-related changes

### Technical Notes
- Database migrations: V001__name.sql
- New dependencies: package-name:version
- Environment variables: VAR_NAME
- Breaking changes: describe what breaks
- Migration guide: steps to upgrade
```

## ğŸ¨ Writing Style Guide

**âœ… Good Examples:**
- "Added OAuth2 authentication with Google provider"
- "Fixed memory leak in WebSocket connections"
- "Changed API timeout from 30s to 60s"
- "Removed deprecated `/api/v1/users` endpoint"

**âŒ Avoid:**
- "Updated code" (too vague)
- "Refactored UserService class" (too technical)
- "Fixed stuff" (not specific)
- "Implemented feature" (what feature?)

## ğŸ”— Resources

- Full Documentation: [CHANGELOG_SYSTEM_README.md](./CHANGELOG_SYSTEM_README.md)
- Template: [CHANGELOG_TEMPLATE.md](./CHANGELOG_TEMPLATE.md)
- Keep a Changelog: https://keepachangelog.com/
- Semantic Versioning: https://semver.org/

---

**Questions?** Check the [full documentation](./CHANGELOG_SYSTEM_README.md) or refer to the [template file](./CHANGELOG_TEMPLATE.md) for detailed examples.
